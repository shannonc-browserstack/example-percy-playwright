# 1. Workflow Name
name: CI Build and Test

# 2. Trigger Events
on: [push, pull_request]

# 3. Jobs to Execute
jobs:
  build_and_test:
    # 4. Runner (Virtual Machine) Environment
    runs-on: ubuntu-latest

    env:
      PERCY_TOKEN: ${{ secrets.PERCY_TOKEN }}
    
    # 5. Steps (Sequential Tasks)
    steps:
    
    # Check out the code from the repository
    - name: Checkout code
      uses: actions/checkout@v4
      
    # Setup the language environment (e.g., Node.js, Python, Java)
    - name: Set up Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20' # Use your project's version
        
    # Install dependencies
    - name: Install dependencies
      run: npm install

    # Install Playwright Browsers
    - name: Install Playwright Browsers
      run: npx playwright install
      
    # Run the build command (if your project has one)
    - name: Run Percy Visual Tests
      run: npm run test-web # Use 'npm run build' or similar command